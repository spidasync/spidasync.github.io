<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CalculEase</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f2f5;
            color: #333;
            overflow: hidden; /* Prevents body scrollbar */
        }

        .calculator {
            background-color: #ffffff;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 25px;
            width: 350px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .calculator-brand {
            font-size: 24px;
            font-weight: 700;
            color: #4a90e2;
            margin-bottom: 20px;
            letter-spacing: 0.5px;
        }

        .display {
            width: 100%;
            height: 80px;
            background-color: #e9ecef;
            border: none;
            border-radius: 12px;
            margin-bottom: 20px;
            padding: 10px 20px;
            font-size: 3.5em;
            text-align: right;
            color: #343a40;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: clip;
            box-sizing: border-box;
            font-weight: 300;
        }

        .buttons-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            width: 100%;
        }

        .buttons-grid button {
            width: 100%;
            height: 70px;
            font-size: 1.8em;
            border: none;
            border-radius: 35px;
            cursor: pointer;
            transition: all 0.2s ease;
            outline: none;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: 500;
            user-select: none; /* Prevent text selection on buttons */
        }

        .buttons-grid button:active {
            transform: scale(0.95);
        }

        /* Number and Decimal Buttons */
        .buttons-grid button.number,
        .buttons-grid button.decimal {
            background-color: #f8f9fa;
            color: #495057;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        .buttons-grid button.number:hover,
        .buttons-grid button.decimal:hover {
            background-color: #e2e6ea;
        }

        /* Operator Buttons */
        .buttons-grid button.operator {
            background-color: #4a90e2; /* Blue */
            color: #ffffff;
            font-weight: bold;
        }
        .buttons-grid button.operator:hover {
            background-color: #357ABD;
        }

        /* Clear and Delete Buttons */
        .buttons-grid button.clear,
        .buttons-grid button.delete {
            background-color: #adb5bd; /* Gray */
            color: #ffffff;
        }
        .buttons-grid button.clear:hover,
        .buttons-grid button.delete:hover {
            background-color: #8c9298;
        }

        /* Equals Button */
        .buttons-grid button.equals {
            background-color: #28a745; /* Green */
            color: #ffffff;
            grid-column: span 2;
            border-radius: 35px;
        }
        .buttons-grid button.equals:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>
    <div class="calculator">
        <div class="calculator-brand">CalculEase</div>
        <input type="text" class="display" value="0" readonly>
        <div class="buttons-grid">
            <button class="clear" data-type="clear">C</button>
            <button class="delete" data-type="delete"><i class="fas fa-backspace"></i></button>
            <button class="operator" data-type="operator" data-value="%">&percnt;</button>
            <button class="operator" data-type="operator" data-value="/">&divide;</button>

            <button class="number" data-type="number" data-value="7">7</button>
            <button class="number" data-type="number" data-value="8">8</button>
            <button class="number" data-type="number" data-value="9">9</button>
            <button class="operator" data-type="operator" data-value="*">&times;</button>

            <button class="number" data-type="number" data-value="4">4</button>
            <button class="number" data-type="number" data-value="5">5</button>
            <button class="number" data-type="number" data-value="6">6</button>
            <button class="operator" data-type="operator" data-value="-">&minus;</button>

            <button class="number" data-type="number" data-value="1">1</button>
            <button class="number" data-type="number" data-value="2">2</button>
            <button class="number" data-type="number" data-value="3">3</button>
            <button class="operator" data-type="operator" data-value="+">&plus;</button>

            <button class="number" data-type="number" data-value="0">0</button>
            <button class="decimal" data-type="decimal" data-value=".">.</button>
            <button class="equals" data-type="equals">=</button>
        </div>
    </div>

    <script>
        const display = document.querySelector('.display');
        let currentInput = '';
        let previousInput = '';
        let operator = null;
        let shouldResetDisplay = false; // Flag to indicate if display should be reset for a new number

        function clear() {
            currentInput = '';
            previousInput = '';
            operator = null;
            shouldResetDisplay = false;
            display.value = '0';
        }

        function deleteLast() {
            if (display.value === '0' && currentInput === '') return; // Don't delete from initial 0 or empty input

            if (shouldResetDisplay) { // If an operation just finished, delete should clear current result and allow new input
                currentInput = '';
                shouldResetDisplay = false;
                display.value = '0';
                return;
            }

            currentInput = currentInput.slice(0, -1);
            if (currentInput === '') {
                display.value = '0'; // If nothing left, show '0'
            } else {
                display.value = currentInput;
            }
        }

        function appendNumber(number) {
            if (display.value === 'Error' || display.value === 'NaN' || display.value === 'Infinity') {
                clear(); // Clear previous error state
            }
            if (shouldResetDisplay) {
                currentInput = number;
                shouldResetDisplay = false;
            } else {
                // Prevent multiple leading zeros unless it's a decimal
                if (number === '0' && currentInput === '0' && !currentInput.includes('.')) {
                    return;
                }
                // If starting with 0 and not a decimal, replace 0 with new digit
                if (currentInput === '0' && number !== '.') {
                    currentInput = number;
                } else {
                    currentInput += number;
                }
            }
            display.value = currentInput;
        }

        function chooseOperator(selectedOperator) {
            if (currentInput === '' && previousInput === '') return; // No input yet

            if (currentInput === '' && previousInput !== '') { // Operator changed without new number
                operator = selectedOperator;
                return;
            }

            if (previousInput !== '') {
                calculate(); // Calculate result of previous operation if one exists
            }
            operator = selectedOperator;
            previousInput = display.value; // Store current display value as previous input
            currentInput = ''; // Clear current input for next number
            shouldResetDisplay = true; // Next number entered should replace current display
        }

        function calculate() {
            let computation;
            const prev = parseFloat(previousInput);
            const current = parseFloat(currentInput);

            if (isNaN(prev) || isNaN(current)) return;

            switch (operator) {
                case '+':
                    computation = prev + current;
                    break;
                case '-':
                    computation = prev - current;
                    break;
                case '*':
                    computation = prev * current;
                    break;
                case '/':
                    if (current === 0) {
                        display.value = 'Error'; // Division by zero
                        currentInput = ''; // Reset state for error
                        previousInput = '';
                        operator = null;
                        return;
                    }
                    computation = prev / current;
                    break;
                case '%': // Modulo operator
                    computation = prev % current;
                    break;
                default:
                    return;
            }

            // Handle potential floating point inaccuracies and format for display
            display.value = parseFloat(computation.toFixed(10)).toString();
            currentInput = display.value;
            operator = null;
            previousInput = '';
            shouldResetDisplay = true; // After calculation, next number should clear display
        }

        function appendDecimal() {
            if (display.value === 'Error' || display.value === 'NaN' || display.value === 'Infinity') {
                clear();
            }
            if (shouldResetDisplay) { // If display should be reset, start with "0."
                currentInput = '0.';
                shouldResetDisplay = false;
            } else if (!currentInput.includes('.')) {
                currentInput = currentInput === '' ? '0.' : currentInput + '.';
            }
            display.value = currentInput;
        }

        document.querySelectorAll('.buttons-grid button').forEach(button => {
            button.addEventListener('click', () => {
                const type = button.dataset.type;
                const value = button.dataset.value;

                if (type === 'number') {
                    appendNumber(value);
                } else if (type === 'operator') {
                    chooseOperator(value);
                } else if (type === 'equals') {
                    calculate();
                } else if (type === 'clear') {
                    clear();
                } else if (type === 'delete') {
                    deleteLast();
                } else if (type === 'decimal') {
                    appendDecimal();
                }
            });
        });

        // Initialize display on load
        clear();
    </script>
</body>
</html>